# CR-0004 — Repo Hardening + Evidence Bundle Fix

## Scope
This ceremony reviews the repo as a portfolio artifact and hardens the runtime surface so:
- the MVP can run end-to-end,
- the share bundle is generated reliably,
- CI catches syntax/import failures early,
- docs have a single canonical “what to run” entry point.

## Key findings (pre-fix)
- **Blocker:** `src/inkswarm_detectlab/share/evidence.py` was corrupted (syntax errors) and could crash any run that imports the MVP orchestrator.
- CI did not run a compile/syntax pass, so this kind of corruption could slip through.

## Changes applied
- Rewrote `share/evidence.py` to:
  - package the share bundle without deleting the pre-generated `share/ui_bundle/`
  - write a deterministic `evidence_manifest.json` (excluding itself)
- Fixed `mvp/orchestrator.py`:
  - corrected indentation for readability
  - fixed a `NameError` path in `write_exec_summary` (fail-soft, but wrong variable)
- Added missing dependency: `numpy` (was imported directly but not declared)
- CI improvement: added `python -m compileall src`
- Added unit test: `tests/test_share_evidence.py`
- Docs curation:
  - added `docs/runbook.md` (canonical commands)
  - added `docs/repo_map.md` (high-signal repo map)
  - simplified `docs/index.md` and `docs/mvp_user_guide.md`
  - rewrote root `README.md` for accuracy
- Removed accidental duplicate repo copy under `configs/` (kept only YAML configs + README)

## Verification steps
1) `python -m compileall src`
2) `pytest -q`
3) Run MVP:
   - `detectlab run mvp -c configs/skynet_mvp.yaml --run-id MVP_001 --force`
4) Open UI:
   - `runs/MVP_001/share/ui_bundle/index.html`
5) Confirm evidence artifacts:
   - `runs/MVP_001/share/evidence_manifest.json`
   - `runs/MVP_001/share/reports/summary.md`

## Next recommended work
- Add a lightweight “import smoke” test for the CLI command tree.
- Add doc lint for broken intra-doc paths (MkDocs build in CI).
- Expand RR evidence documentation (what constitutes PASS/FAIL in human terms).
